-- Функция декартова расстояния между двумя точками 

-- Скалярное произведение двух векторов (каждый вектор создается одной точкой из начала координат)


-- | Точка в двумерном пространстве
-- Определяем тип данных Point с двумя полями: x и y типа Double
data Point = Point { x :: Double, y :: Double } deriving (Show, Eq)

-- | Декартово расстояние между двумя точками
-- Функция принимает две точки и возвращает расстояние между ними
distance :: Point -> Point -> Double
-- Извлекаем координаты первой точки (x1, y1) и второй точки (x2, y2)
distance (Point x1 y1) (Point x2 y2) = 
    -- Вычисляем квадрат разности по x и квадрат разности по y, суммируем их и извлекаем квадратный корень
    sqrt ((x1 - x2)^2 + (y1 - y2)^2)

-- | Скалярное произведение двух векторов
-- Каждый вектор задается точкой из начала координат (0,0)
-- Функция принимает два вектора-точки и возвращает их скалярное произведение
dotProduct :: Point -> Point -> Double
-- Извлекаем координаты первого вектора (x1, y1) и второго вектора (x2, y2)
dotProduct (Point x1 y1) (Point x2 y2) = 
    -- Вычисляем скалярное произведение: x1*x2 + y1*y2
    x1 * x2 + y1 * y2

-- | Вычисление угла между двумя векторами (в радианах)
-- Функция принимает два вектора-точки и возвращает угол между ними в радианах
angleBetween :: Point -> Point -> Double
-- Вычисляем угол с помощью арккосинуса от отношения скалярного произведения к произведению длин векторов
angleBetween v1 v2 = 
    acos (
        -- Скалярное произведение векторов
        dotProduct v1 v2 / 
        -- Произведение длин векторов (расстояний от начала координат до точек)
        (distance (Point 0 0) v1 * distance (Point 0 0) v2)
    )

-- | Примеры использования
-- Главная функция программы
main :: IO ()
main = do
    let pointA = Point 0.0 4.0
    let pointB = Point 3.0 0.0
    
    putStrLn $ "Точка A: " ++ show pointA
    putStrLn $ "Точка B: " ++ show pointB
    
    putStrLn $ "Расстояние A-B: " ++ show (distance pointA pointB)
    -- Выводим скалярное произведение векторов OA и OB
    putStrLn $ "Скалярное произведение A·B: " ++ show (dotProduct pointA pointB)
    -- Выводим угол между векторами в радианах
    putStrLn $ "Угол между векторами A и B (радианы): " ++ show (angleBetween pointA pointB)
    -- Выводим угол между векторами в градусах (переводим из радиан)
    putStrLn $ "Угол между векторами A и B (градусы): " ++ show (angleBetween pointA pointB * 180 / pi)